{"ast":null,"code":"export default class HubBridge {\n  constructor(url) {\n    this.iframe = null;\n    this.msgId = 0;\n    this.url = url;\n  }\n\n  async registerWallet(name) {\n    await this.ensureIFrame();\n    await this.send('registerWallet', {\n      name\n    });\n  }\n\n  ensureIFrame() {\n    if (this.iframe) {\n      return Promise.resolve(this.iframe);\n    }\n\n    return new Promise(resolve => {\n      this.iframe = document.createElement('iframe');\n      this.iframe.src = this.url;\n      this.iframe.style.cssText = 'height:0; width:0; border:none; position: absolute';\n      this.iframe.addEventListener('load', () => resolve());\n      document.body.appendChild(this.iframe);\n    });\n  }\n\n  send(command, props) {\n    return new Promise(resolve => {\n      const id = this.msgId++;\n\n      const listener = e => {\n        if (e.data.id === id) {\n          window.removeEventListener('message', listener);\n          resolve(e.data.response);\n        }\n      };\n\n      window.addEventListener('message', listener);\n      this.iframe.contentWindow.postMessage({\n        command,\n        id,\n        ...props\n      }, this.url);\n    });\n  }\n\n}","map":null,"metadata":{},"sourceType":"module"}