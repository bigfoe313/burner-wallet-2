{"ast":null,"code":"import _regeneratorRuntime from \"/home/aforbers/burner-wallet-2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/aforbers/burner-wallet-2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/home/aforbers/burner-wallet-2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/aforbers/burner-wallet-2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport ENS from './ENS';\n\nvar ENSPlugin =\n/*#__PURE__*/\nfunction () {\n  function ENSPlugin() {\n    var network = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '1';\n\n    _classCallCheck(this, ENSPlugin);\n\n    this.ensCache = {};\n    this.reverseCache = {};\n    this.ens = null;\n    this.network = network;\n  }\n\n  _createClass(ENSPlugin, [{\n    key: \"initializePlugin\",\n    value: function initializePlugin(pluginContext) {\n      var _this = this;\n\n      this.ens = new ENS(pluginContext.getWeb3(this.network), this.network);\n      pluginContext.addAddressToNameResolver(function (address) {\n        return _this.lookupName(address);\n      });\n      pluginContext.onAccountSearch(function (search) {\n        return search.length > 3 && search.indexOf('.') !== -1 ? _this.ensSearch(search) : Promise.resolve([]);\n      });\n    }\n  }, {\n    key: \"lookupName\",\n    value: function () {\n      var _lookupName = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(address) {\n        var name;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                if (!(this.reverseCache[address] !== undefined)) {\n                  _context.next = 2;\n                  break;\n                }\n\n                return _context.abrupt(\"return\", this.reverseCache[address]);\n\n              case 2:\n                _context.prev = 2;\n                _context.next = 5;\n                return this.ens.reverseLookup(address);\n\n              case 5:\n                name = _context.sent;\n                this.reverseCache[address] = name;\n                return _context.abrupt(\"return\", name);\n\n              case 10:\n                _context.prev = 10;\n                _context.t0 = _context[\"catch\"](2);\n                console.warn('Reverse ENS error', _context.t0);\n                return _context.abrupt(\"return\", null);\n\n              case 14:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[2, 10]]);\n      }));\n\n      function lookupName(_x) {\n        return _lookupName.apply(this, arguments);\n      }\n\n      return lookupName;\n    }()\n  }, {\n    key: \"ensSearch\",\n    value: function () {\n      var _ensSearch = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee2(search) {\n        var cached, address;\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                cached = this.ensCache[search];\n\n                if (!(cached !== undefined)) {\n                  _context2.next = 3;\n                  break;\n                }\n\n                return _context2.abrupt(\"return\", cached ? [{\n                  name: search,\n                  address: cached\n                }] : []);\n\n              case 3:\n                _context2.next = 5;\n                return this.ens.getAddress(search);\n\n              case 5:\n                address = _context2.sent;\n                this.ensCache[search] = address;\n                return _context2.abrupt(\"return\", address ? [{\n                  name: search,\n                  address: address\n                }] : []);\n\n              case 8:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function ensSearch(_x2) {\n        return _ensSearch.apply(this, arguments);\n      }\n\n      return ensSearch;\n    }()\n  }]);\n\n  return ENSPlugin;\n}();\n\nexport { ENSPlugin as default };","map":null,"metadata":{},"sourceType":"module"}